{% extends 'base.html' %}
{% block content %}

<div class="col-md-6 offset-md-3">
  {% if user.is_authenticated %}
    <h1 class="text-center">Welcome, {{ user.username }}!</h1>
    <div class="mt-4">
      <h2 class="mb-3">To-Do List</h2>
      <!-- Input for adding a task -->
      <div class="input-group mb-3">
        <input id="taskInput" type="text" class="form-control" placeholder="Enter a new task" />
        <button id="addTaskBtn" class="btn btn-primary">Add Task</button>
      </div>

      <!-- Task List -->
      <ul id="taskList" class="list-group">
        <!-- Tasks will appear here dynamically -->
      </ul>
    </div>

    <script>
      // JavaScript for To-Do List Functionality
      document.addEventListener("DOMContentLoaded", function () {
        const taskInput = document.getElementById("taskInput");
        const addTaskBtn = document.getElementById("addTaskBtn");
        const taskList = document.getElementById("taskList");

        // Add task function
        addTaskBtn.addEventListener("click", function () {
          const taskText = taskInput.value.trim();
          if (taskText === "") return;

          // Create new task element
          const li = document.createElement("li");
          li.className = "list-group-item d-flex justify-content-between align-items-center";

          // Task text
          const taskSpan = document.createElement("span");
          taskSpan.textContent = taskText;
          taskSpan.style.textDecoration = "none";
          li.appendChild(taskSpan);

          // Actions (check and remove)
          const actionsDiv = document.createElement("div");

          // Check-off button
          const checkBtn = document.createElement("button");
          checkBtn.className = "btn btn-sm btn-success me-2";
          checkBtn.textContent = "âœ”";
          checkBtn.addEventListener("click", function () {
            if (taskSpan.style.textDecoration === "line-through") {
              taskSpan.style.textDecoration = "none";
            } else {
              taskSpan.style.textDecoration = "line-through";
            }
          });

          // Remove button
          const removeBtn = document.createElement("button");
          removeBtn.className = "btn btn-sm btn-danger";
          removeBtn.textContent = "ðŸ—‘";
          removeBtn.addEventListener("click", function () {
            taskList.removeChild(li);
          });

          actionsDiv.appendChild(checkBtn);
          actionsDiv.appendChild(removeBtn);
          li.appendChild(actionsDiv);

          // Add task to list
          taskList.appendChild(li);

          // Clear input field
          taskInput.value = "";
        });
      });
    </script>
  {% else %}
    <h1>Login</h1>
    <form method="POST" action="{% url 'home' %}">
      {% csrf_token %}
      <form>
        <div class="mb-3">
          <label for="exampleInputEmail1" class="form-label">Username</label>
          <input type="text" class="form-control" name="username" required>
        </div>
        <div class="mb-3">
          <label for="exampleInputPassword1" class="form-label">Password</label>
          <input type="password" class="form-control" name="password" required>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </form>
  {% endif %}
</div>

{% endblock %}
